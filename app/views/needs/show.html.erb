<div class="display-group-square-rfb">
  <!------------------------------------------ DETAIL SECTION --------------------------------------------->
  <h3>Detalhes da Necessidade</h3>
  <div>
    <div class="row my-1">
      <div class="col-1 d-flex justify-content-between pr-0">
        <label>Título:</label>
      </div>

      <div class="col-lg-8">
        <p> <%= @need.title %>"</p>
      </div>
      <div class="col-lg-3 px-2 reduce-ml-on-shrink" style="min-width: 247px; max-width: 247px; margin-left: 19px;">
        <label>Status:</label>
        <p> <%= @need.status %></p>
      </div>
    </div>

    <div class="row my-1">
      <div class="col-lg-1">
        <label>Endreço:</label>
      </div>
      <div class="col-lg-7">
        <p> <%= @need.address %> </p>
      </div>
      <div class="col-lg-4 px-2 reduce-ml-on-shrink" style="margin-left: 31px; max-width: 326px; min-width: 326px;">
        <label>Prazo Propostas: </label>
        <p> <%= @need.deadline.strftime("%D%y, %Hh%M") %> </p>
      </div>

    </div>

    <div class="row my-1">
      <div class="col-lg-12">
        <label>Descrição : </label>
        <textarea class="form-control" rows="3" disabled><%= @need.description %></textarea>
      </div>
    </div>

    <div class="row my-1 mb-3">
      <div class="col-lg-12">
        <label>Despacho : </label><textarea class="form-control" rows="3" disabled><%= @need.verdict %></textarea>
      </div >
    </div>

    <% if current_user.government && (!['inativa', 'concluída'].include?(@need.status))%>
      <div class="row mb-3">
        <div class="col-lg-12 text-right">
            <%= link_to 'Inativar necessidade', need_path(@need),  method: :delete,  class: 'btn-text-blue-rfb ml-0' %>
        </div>
      </div>
    <% end %>
  </div>


  <!------------------------------------------ PROPOSAL SECTION --------------------------------------------->
  <div class="display-group-square-rfb">

    <% if current_user.government %>
      <h3>Propostas Vinculadas</h3>
      <div>
        <div class="row">
          <div class="col-lg-2">
            <label>Valor (R$)</label>
          </div>
          <div class="col-lg-2">
            <label>Autor</label>
          </div>
          <div class="col-lg-8">
            <label>Descrição</label>
          </div>
        </div>
        <% @proposals.each do |proposal| %>
          <div class="row">
            <div class="col-lg-2">
              <p><%= number_with_delimiter(proposal.value, delimiter: '.', separator: ',', precision: 2) %></p>
            </div>
            <div class="col-lg-2">
              <p><%= proposal.user.name %></p>
            </div>
            <div class="col-lg-8">
              <p><%= proposal.description %></p>
            </div>
          </div>
        <% end %>
      </div>

    <% else %>

      <% if @proposal.id.nil? %>
        <h3>Nova Proposta</h3>
        <%= simple_form_for([@need, @proposal]) do |f| %>
          <%= f.input :value, label: 'Valor (R$): ' %>
          <%= f.input :description, label: 'Descrição', hint: 'Detalhes específicos da proposta.'%>
          <%= f.submit %>
        <% end %>
      <% else %>
        <!-- If a proposal was already made by the user -->

        <h3>Proposta Efetuada</h3>

        <p><strong>Valor R$ : </strong> <%= @proposal.value %></p>
        <p><strong>Descrição: </strong> <%= @proposal.description %></p>

        <%= simple_form_for(@proposal) do |f| %>
          <%= f.input :value, label: 'Valor (R$): ', disabled: true %>
          <%= f.input :description, label: 'Descrição', disabled: true, hint: 'Detalhes específicos da proposta.'%>
          <div class="btn btn-secondary mr-1" id="edit-button"> Editar Proposta </div>
          <%= f.submit disabled: true, class:"btn btn-secondary mr-1", id: "btn-update"%>
        <% end %>
      <% end %>
    <% end %>
  </div>
</div>
